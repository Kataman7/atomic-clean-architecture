version: '3'

services:
  app:
    build:
      context: ./code
      dockerfile: Dockerfile.dev
    ports:
      - "5173:5173"
    restart: unless-stopped
    volumes:
      - ./code:/app
      - /app/node_modules
      - ./build:/build
    environment:
      - CHOKIDAR_USEPOLLING=true

  # The previous `build` service was removed. Use the `app` service to develop
  # and run `npm run build:host` inside it to populate `./build` on the host.